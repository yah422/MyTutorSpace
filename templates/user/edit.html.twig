{% extends 'base.html.twig' %}

{% block title %}Modifier le profil{% endblock %}

{% block body %}
<div class="flex items-center justify-center min-h-screen" style="background-color: #1B4255;">
    <div class="container mx-auto max-w-4xl p-6 rounded-lg shadow-lg" style="background-color: #567C8D;">
        <h1 class="text-3xl font-bold mb-8 text-center" style="color: #FFD700;">Modifier le profil</h1>

        {# Affichage des messages flash #}
        {% for message in app.flashes('success') %}
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
            {{ message }}
        </div>
        {% endfor %}

        {% for message in app.flashes('error') %}
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
            {{ message }}
        </div>
        {% endfor %}

        {{ form_start(form, { 'attr': { 'class': 'space-y-6' } }) }}

        {# Photo de profil actuelle #}
        {% if user.profilePicture %}
        <div class="mb-4 text-center">
            <img src="{{ asset('uploads/avatars/' ~ user.profilePicture) }}" alt="Photo de profil"
                class="w-32 h-32 rounded-full mx-auto mb-2 object-cover border-4 border-[#FFD700]">
            <p class="text-gray-300">Photo de profil actuelle</p>
        </div>
        {% endif %}

        {# Champ pour la nouvelle photo #}
        <div class="mb-4">
            {{ form_label(form.image, 'Nouvelle photo de profil', {'label_attr': {'class': 'block font-semibold
            text-gray-300 mb-2'}}) }}
            {{ form_widget(form.image, {
            'attr': {
            'class': 'w-full bg-[#1B4255] text-gray-200 rounded p-3 border border-gray-400 focus:ring-2
            focus:ring-[#FFD700]'
            }
            }) }}
            <small class="text-gray-300">Formats accept√©s : JPG, JPEG, PNG. Taille maximale : 5MB</small>
        </div>

        <!-- HourlyRate -->
        {% if app.user and 'ROLE_TUTEUR' in app.user.roles %}
        <div> 
            {{ form_row(form.hourly_rate, {'attr': {'class': 'w-full bg-[#1B4255] text-gray-200 rounded p-3 border border-gray-400 focus:ring-2
            focus:ring-[#FFD700]'}}) }}
        </div>
        {% endif %}

        {# Autres champs du formulaire, en excluant "profilePicture" et "hourly_rate" #}
        {% for field in form %}
        {% if field.vars.name != 'image' and field.vars.name != 'hourly_rate' %}
        <div class="mb-4">
            {{ form_label(field, null, {'label_attr': {'class': 'block font-semibold text-gray-300 mb-2'}}) }}
            {{ form_widget(field, {
            'attr': {
            'class': 'w-full bg-[#1B4255] text-gray-200 rounded p-3 border border-gray-400 focus:ring-2
            focus:ring-[#FFD700]'
            }
            }) }}
            {{ form_errors(field, {'attr': {'class': 'text-red-500 mt-1'}}) }}
        </div>
        {% endif %}
        {% endfor %}

        {# Boutons d'action #}
        <div class="flex justify-center gap-4 mt-6">
            <a href="{{ path('app_show_user', {'id': user.id}) }}"
                class="bg-gray-500 text-white font-bold py-3 px-6 rounded transition duration-200 hover:bg-gray-600">
                Annuler
            </a>
            <button type="submit" class="font-bold py-3 px-6 rounded transition duration-200 hover:bg-[#FFE44D]"
                style="background-color: #FFD700; color: #1B4255;">
                Enregistrer
            </button>
        </div>

        {{ form_end(form) }}
    </div>
</div>
{% endblock %}